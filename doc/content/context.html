<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="../code_style.css">
    <script src="../highlight.pack.js"></script>
    <script src="../code.js"></script>

    <link rel="stylesheet" type="text/css" href="../style.css">
    <meta charset="UTF-8">
    <title>Context / apptronic.net core framework</title>
</head>
<body>
<div class="content">
    <div class="inner_link"><a href="../index.html">Documentation</a> - Context</div>
    <div class="page_title">Context</div>
    <div class="section_title">Basics</div>
    <div class="section_paragraph">
        Class
        <div class="code_inline">net.apptronic.core.component.context.Context</div>
        is a base of the framework.
    </div>
    <div class="section_subtitle">Definition</div>
    <div class="section_paragraph">
        <div class="code_inline">Context</div>
        represents a logical part of application, as whole application at same time. Each context should be defined
        according to separate, isolated from other part of application and define any of layers. For example:
        <pre><code>class ApplicationContext : Context</code></pre>
        <div class="code_description">
            <div class="code_inline">ApplicationContext</div>
            defines whole app context.
        </div>
        <pre><code>class ApplicationScreenContext : ViewModelContext</code></pre>
        <div class="code_description">
            <div class="code_inline">ApplicationScreenContext</div>
            defines app UI context.
        </div>
        <pre><code>class SynchronizationServiceContext : Context</code></pre>
        <div class="code_description">
            <div class="code_inline">SynchronizationServiceContext</div>
            defines synchronization service context.
        </div>
        <pre><code>class LoginScreenContext : ViewModelContext</code></pre>
        <div class="code_description">
            <div class="code_inline">LoginScreenContext</div>
            defines context for exactly login screen.
        </div>

    </div>
    <div class="section_subtitle">Implementation</div>
    <div class="section_paragraph">
        Basically context cannot exist standalone. But it needed to declare at least core context for whole app.
        <pre><code>class ApplicationContext(platform: Platform) : CoreContext(platform) {
    init {
        // context initialization
    }
}</code></pre>
        <div class="code_description">
            <div class="code_inline">ApplicationContext</div>
            defines whole app context.
            <div class="code_inline">Platform</div>
            provides platform specific features and comes bundled with framework. You need to provide concrete platform
            instance when creating
            <div class="code_inline">ApplicationContext</div>
            at the target platform.
        </div>
        <pre><code>class ServiceContext(parent: Context) : SubContext(parent) {

    init {
        // context initialization
    }

}</code></pre>
        <div class="code_description">
            <div class="code_inline">ServiceContext</div>
            defines whole context of some service.
            <div class="code_inline">parent</div>
            can be any instance of context. For example, in can be
            <div class="code_inline">ApplicationContext</div><!--remove_space-->.
        </div>

        <pre><code>class LoginScreenContext(parent: Context) : ViewModelContext(parent) {

    init {
        // context initialization<
    }

}</code></pre>
        <div class="code_description">
            <div class="code_inline">LoginScreenContext</div>
            defines context of login screen.
            <div class="code_inline">parent</div>
            can be any instance of context. For example, in can be
            <div class="code_inline">ApplicationContext</div>
            or
            <div class="code_inline">ApplicationScreenContext</div><!--remove_space-->.
        </div>

    </div>
    <div class="section_title">How to use context</div>

    <div class="section_subtitle">Setup Scheduler</div>
    <div class="section_paragraph">
        Setup
        <div class="code_inline">Scheduler</div>
        to define threading behavior for all
        <div class="code_inline">Component</div><!--remove_space-->s inside
        <div class="code_inline">Context</div><!--remove_space-->.
        <pre><code>class ConcreteContext(parent: Context) : ViewModelContext(parent) {

    init {
        getScheduler().assignWorker(
            WorkerDefinition.BACKGROUND_SINGLE_SHARED,
            InstanceWorkerProvider(singleThreadWorker())
        )
        getScheduler().assignWorker(
            WorkerDefinition.BACKGROUND_PARALLEL_INDIVIDUAL,
            InstanceWorkerProvider(parallelWorker(threads = 4))
        )
    }

}</code></pre>
        If specific behavior is not needed - default setup can be used. More info about default setup:
        <div class="inner_link"><a href="scheduler.html">Read full description of Scheduler</a></div>
    </div>

    <div class="section_subtitle">Setup dependencies</div>
    <div class="section_paragraph">
        Setup
        <div class="code_inline">DependencyProvider</div>
        to define entities which can be injected inside all
        <div class="code_inline">Component</div><!--remove_space-->s under this
        <div class="code_inline">Context</div><!--remove_space-->.
        <pre><code>val SomeCountDescriptor = createDescriptor&lt;Int&gt;()
val InstanceDescriptor = createDescriptor&lt;SomeInterface&gt;()

class ConcreteContext(parent: Context, count: Int) : ViewModelContext(parent) {

    init {
        getProvider().addInstance(SomeCountDescriptor, count)
        getProvider().addModule(SomeModule)
    }

}

val SomeModule = declareModule {
    factory(InstanceDescriptor) {
        SomeInterfaceImpl()
    }
}</code></pre>
    </div>

</div>
</body>
</html>